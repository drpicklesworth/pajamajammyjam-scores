<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pajama Jammy Jam - Leaderboard</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body {
    background: linear-gradient(135deg,#0f0c29 0%,#302b63 50%,#24243e 100%);
    min-height:100vh;
    font-family:'Courier New', monospace;
    padding:40px 20px;
    overflow-x:hidden;
    color:#d4af37;
}
.header { position:fixed; top:0; left:0; right:0; padding:40px 20px 20px;
    background: linear-gradient(135deg,#0f0c29 0%,#302b63 50%,#24243e 100%);
    z-index:100; text-align:center;
}
.main-title { font-size:60px; font-family:'Great Vibes', cursive; text-shadow:3px 3px 6px rgba(0,0,0,0.7);}
.subtitle { font-size:20px; opacity:0.8; letter-spacing:3px; text-transform:uppercase; margin-top:5px;}
.content-wrapper { margin-top:200px; display:flex; justify-content:center; align-items:center; min-height:calc(100vh-250px);}
.leaderboard-container { display:flex; justify-content:center; align-items:flex-end; gap:30px; flex-wrap:wrap; max-width:100%; }
.participant-card { display:flex; flex-direction:column; align-items:center; transition:all 0.8s ease; position:relative; }
.frame { width:180px;height:220px; background:linear-gradient(145deg,#e6c04f 0%,#c4a747 100%);
    padding:12px;border-radius:8px; box-shadow:0 10px 30px rgba(0,0,0,0.5), inset 0 2px 6px rgba(255,255,255,0.4); border:4px solid #8b6914; position:relative;}
.frame::before { content:''; position:absolute; top:-4px; left:-4px; right:-4px; bottom:-4px;
    background: radial-gradient(circle at 0 0, transparent 8px, #8b6914 8px, #8b6914 12px, transparent 12px),
                radial-gradient(circle at 100% 0, transparent 8px, #8b6914 8px, #8b6914 12px, transparent 12px),
                radial-gradient(circle at 0 100%, transparent 8px, #8b6914 8px, #8b6914 12px, transparent 12px),
                radial-gradient(circle at 100% 100%, transparent 8px, #8b6914 8px, #8b6914 12px, transparent 12px);
    background-size:50% 50%; background-repeat:no-repeat;
    background-position: top left, top right, bottom left, bottom right; pointer-events:none; border-radius:8px;
}
.photo-container { width:100%; height:100%; background:#2a2a2a; border-radius:2px; overflow:hidden; position:relative; }
.photo { width:100%; height:100%; object-fit:cover; }
.name-tag { margin-top:15px; background:rgba(212,175,55,0.2); padding:8px 20px; border-radius:20px; border:2px solid #d4af37; font-weight:bold; text-shadow:1px 1px 2px rgba(0,0,0,0.5); text-align:center; }
.score { margin-top:10px; font-size:32px; color:#fff; font-weight:bold; text-shadow:2px 2px 4px rgba(0,0,0,0.7); }
.rank { margin-top:5px; font-size:18px; font-weight:bold; color:#ffd700; text-shadow:1px 1px 2px #000; }
.rank-1 .frame { border-color: gold; box-shadow: 0 10px 30px rgba(255,215,0,0.7), inset 0 2px 6px rgba(255,255,255,0.4); }
.rank-2 .frame { border-color: silver; box-shadow: 0 10px 30px rgba(192,192,192,0.7), inset 0 2px 6px rgba(255,255,255,0.4); }
.rank-3 .frame { border-color: #cd7f32; box-shadow: 0 10px 30px rgba(205,127,50,0.7), inset 0 2px 6px rgba(255,255,255,0.4); }
.loading, .error { text-align:center; font-size:18px; margin-top:50px; }
.shimmer { height: 220px; width: 180px; border-radius: 8px; background: linear-gradient(90deg, #333 25%, #444 50%, #333 75%); background-size: 400% 100%; animation: shimmer 1.5s infinite; }
@keyframes shimmer { 0% { background-position: -400% 0; } 100% { background-position: 400% 0; } }
.version { position:fixed; bottom:10px; right:10px; font-size:11px; opacity:0.7; }
</style>
</head>
<body>
<div class="header">
    <div class="main-title">Pajama Jammy Jam</div>
    <div class="subtitle">Current Scores</div>
</div>
<div class="content-wrapper">
    <div id="content">
        <div class="loading">Loading leaderboardâ€¦</div>
    </div>
</div>
<div class="version" id="version">v2.0</div>

<script>
const SHEET_JSON_URL = 'https://script.google.com/macros/s/AKfycbzU4HDRCWEOG60sKnFLs8RWjgaxtoDtgMfXf0SqTKu13fB0yRCWd1BxlmoMgVfEpnfUkQ/exec';
const fallbackImage = 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/59/User-avatar.svg/240px-User-avatar.svg.png';
let participants = [];

async function loadData() {
    const content = document.getElementById('content');
    content.innerHTML = '<div class="leaderboard-container">' + '<div class="shimmer"></div>'.repeat(3) + '</div>';

    try {
        const res = await fetch(SHEET_JSON_URL);
        const data = await res.json();
        participants = data.sort((a,b)=>b.score - a.score);
        renderLeaderboard();
        document.getElementById('version').innerText = 'v2.0';
    } catch (err) {
        content.innerHTML = `<div class="error">Error loading leaderboard.</div>`;
    }
}

function renderLeaderboard() {
    const container = document.getElementById('content');
    container.innerHTML = '<div class="leaderboard-container"></div>';
    const board = container.querySelector('.leaderboard-container');
    participants.forEach((p,i)=>{
        const card = document.createElement('div');
        card.className = 'participant-card rank-' + (i+1);
        card.innerHTML = `
            <div class="frame">
                <div class="photo-container">
                    <img src="${p.photo || fallbackImage}" alt="${p.name}" class="photo" onerror="this.src='${fallbackImage}'">
                </div>
            </div>
            <div class="rank">#${i+1}</div>
            <div class="name-tag">${p.name}</div>
            <div class="score">${p.score}</div>
        `;
        board.appendChild(card);
    });
}

// Initial load + update every 30 seconds
loadData();
setInterval(loadData, 30000);
</script>
</body>
</html>
